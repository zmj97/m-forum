(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{108:function(t,a,e){"use strict";var s=e(82);e.n(s).a},109:function(t,a,e){(t.exports=e(6)(!1)).push([t.i,"#abstract[data-v-3a7112d5],#buttons[data-v-3a7112d5],#editor[data-v-3a7112d5],#tags[data-v-3a7112d5],#title[data-v-3a7112d5]{margin-top:.5rem}#editor[data-v-3a7112d5]{z-index:1000}.float-right[data-v-3a7112d5]{float:right;margin-right:1rem}#title[data-v-3a7112d5]{width:100%;border:0;padding-left:5px;font-size:40px;outline:none}",""])},129:function(t,a,e){"use strict";e.r(a);var s={name:"NewPostPanel",data(){return{postData:{username:this.$store.state.Users.currentUser.username,title:"",abstract:"",tags:[],content:"输入描述",replys:[]},newTag:"",joinedGroups:[],group:null,modalPost:!1,modalCancel:!1,imgFiles:{}}},methods:{removeTag(t,a){const e=this.postData.tags.indexOf(a);this.postData.tags.splice(e,1)},addTag(){-1===this.postData.tags.indexOf(this.newTag)?10>this.postData.tags.length&&""!==this.newTag&&(this.postData.tags.push(this.newTag),this.newTag=""):this.$Message.warning("标签不可重复！")},$imgAdd(t,a){this.imgFiles[t]=a},$imgDel(t){delete this.imgFiles[t]},async okPost(){return 0===this.postData.title.replace(/\s+/g,"").length?this.$Message.error("标题内容不能为空！"):(this.postData.time=new Date,this.postData.lastModifyTime=this.postData.time,this.group&&(this.postData.group=this.group),{}!==this.imgFiles&&await this.$http.post("/statics/upload",this.imgFiles).then(t=>{t.data.forEach(t=>{this.$refs.md.$img2Url(t[0],t[1])})}),void this.$http.post("/post/create/new",this.postData).then(t=>{"success"===t.data?(this.$Message.success("发布成功"),this.$router.push("/home")):this.$Message.error("数据库连接失败，请重试！")}).catch(t=>{this.$Message.error("网络连接失败!"),console.error(t)}))}},mounted(){this.getJoinedGroups(this.postData.username,this.joinedGroups)}},o=(e(108),e(3)),i=Object(o.a)(s,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{overflow:"auto"}},[e("div",{attrs:{id:"buttons"}},[e("Button",{staticClass:"float-right",attrs:{type:"success"},on:{click:function(){t.modalPost=!0}}},[t._v("发布")]),t._v(" "),e("Modal",{attrs:{title:"发布帖子",zIndex:5e3},on:{"on-ok":t.okPost},model:{value:t.modalPost,callback:function(a){t.modalPost=a},expression:"modalPost"}},[e("p",[t._v("确定要发布这篇帖子么？")])]),t._v(" "),e("Button",{staticClass:"float-right",attrs:{type:"error"},on:{click:function(){t.modalCancel=!0}}},[t._v("放弃")]),t._v(" "),e("Modal",{attrs:{title:"放弃发布",zIndex:5e3},model:{value:t.modalCancel,callback:function(a){t.modalCancel=a},expression:"modalCancel"}},[e("p",[t._v("确定要放弃发布这篇帖子么？您将丢失您编辑的所有内容！")])]),t._v(" "),e("Select",{staticClass:"float-right",staticStyle:{width:"auto"},attrs:{clearable:"",placeholder:"可选择要限定的小组","not-found-text":"您还未加入小组"},model:{value:t.group,callback:function(a){t.group=a},expression:"group"}},t._l(t.joinedGroups,function(a){return e("Option",{key:a,attrs:{value:a}},[t._v("\n        "+t._s(a)+"\n      ")])}),1)],1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.postData.title,expression:"postData.title"}],attrs:{id:"title",type:"text",name:"title",placeholder:"标题，最多输入30个字符",maxlength:30},domProps:{value:t.postData.title},on:{input:function(a){a.target.composing||t.$set(t.postData,"title",a.target.value)}}}),t._v(" "),e("Input",{attrs:{id:"abstract",size:"large",placeholder:"摘要，最多输入100个字符",clearable:"",maxlength:100},model:{value:t.postData.abstract,callback:function(a){t.$set(t.postData,"abstract",a)},expression:"postData.abstract"}}),t._v(" "),e("div",{attrs:{id:"tags"}},[e("span",t._l(t.postData.tags,function(a){return e("Tag",{key:a,attrs:{type:"dot",color:"primary",name:a,closable:""},on:{"on-close":t.removeTag}},[t._v("\n        "+t._s(a)+"\n      ")])}),1),t._v(" "),e("Input",{staticStyle:{width:"180px"},attrs:{placeholder:"回车添加标签，至多10个",prefix:"ios-pricetag"},on:{"on-enter":t.addTag},model:{value:t.newTag,callback:function(a){t.newTag=a},expression:"newTag"}})],1),t._v(" "),e("mathjax-toolbar",{attrs:{contentId:"editor"}}),t._v(" "),e("mavon-editor",{ref:"md",attrs:{id:"editor",ishljs:!0,scrollStyle:!0,autofocus:!1},on:{imgAdd:t.$imgAdd,imgDel:t.$imgDel},model:{value:t.postData.content,callback:function(a){t.$set(t.postData,"content",a)},expression:"postData.content"}})],1)},[],!1,null,"3a7112d5",null);a.default=i.exports},82:function(t,a,e){var s=e(109);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,e(7).default)("6c1755ea",s,!0,{})}}]);